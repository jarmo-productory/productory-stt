#!/bin/sh

# Run ESLint with relaxed configuration
echo "ğŸ” Running ESLint in relaxed mode..."
npm run lint:local || { echo "âŒ ESLint check failed. Please fix the errors before committing."; exit 1; }

# Run Prettier on staged files
echo "ğŸ’… Running Prettier..."
npx prettier --write $(git diff --cached --name-only --diff-filter=ACMR | grep -E '\.(js|jsx|ts|tsx|css|scss|json|md)$')

# Run TypeScript type checking on the entire project
echo "ğŸ” Running TypeScript type checking..."
npm run typecheck || { echo "âŒ TypeScript check failed. Please fix the type errors before committing."; exit 1; }

# Add back the files that Prettier may have modified
git add $(git diff --cached --name-only --diff-filter=ACMR | grep -E '\.(js|jsx|ts|tsx|css|scss|json|md)$')
