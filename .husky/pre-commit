#!/bin/sh

# Run ESLint with relaxed configuration
echo "🔍 Running ESLint in relaxed mode..."
npm run lint:local || { echo "❌ ESLint check failed. Please fix the errors before committing."; exit 1; }

# Run Prettier on staged files
echo "💅 Running Prettier..."
npx prettier --write $(git diff --cached --name-only --diff-filter=ACMR | grep -E '\.(js|jsx|ts|tsx|css|scss|json|md)$')

# Run TypeScript type checking on the entire project
echo "🔎 Running TypeScript type checking..."
npm run typecheck || { echo "❌ TypeScript check failed. Please fix the type errors before committing."; exit 1; }

# Add back the files that Prettier may have modified
git add $(git diff --cached --name-only --diff-filter=ACMR | grep -E '\.(js|jsx|ts|tsx|css|scss|json|md)$')
